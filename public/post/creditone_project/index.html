<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Credit Risk Assessment with Python | Home</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="The prescribed objective for this project was to outline and then implement a data science process—like CRISP-DM—resulting in a model that could reliably predict whether or not a customer would default on their loan(s) from their demographic information, as well as six months worth of data on their billing and payment history.
Obtain Data I obtained the raw data for this project from a MySQL database by establishing a connection to the server, executing a simple SELECT * query, and saving the result/output as a .">
    <meta name="generator" content="Hugo 0.82.1" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    

  
  
    <link rel="stylesheet" href="https://katherinepiatti.com/ananke/dist/main.css_5c99d70a7725bacd4c701e995b969fea.css" >
  




    
      

    

    
    
    <meta property="og:title" content="Credit Risk Assessment with Python" />
<meta property="og:description" content="The prescribed objective for this project was to outline and then implement a data science process—like CRISP-DM—resulting in a model that could reliably predict whether or not a customer would default on their loan(s) from their demographic information, as well as six months worth of data on their billing and payment history.
Obtain Data I obtained the raw data for this project from a MySQL database by establishing a connection to the server, executing a simple SELECT * query, and saving the result/output as a ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://katherinepiatti.com/post/creditone_project/" /><meta property="article:section" content="post" />

<meta property="og:site_name" content="Home" />

<meta itemprop="name" content="Credit Risk Assessment with Python">
<meta itemprop="description" content="The prescribed objective for this project was to outline and then implement a data science process—like CRISP-DM—resulting in a model that could reliably predict whether or not a customer would default on their loan(s) from their demographic information, as well as six months worth of data on their billing and payment history.
Obtain Data I obtained the raw data for this project from a MySQL database by establishing a connection to the server, executing a simple SELECT * query, and saving the result/output as a .">

<meta itemprop="wordCount" content="2474">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Credit Risk Assessment with Python"/>
<meta name="twitter:description" content="The prescribed objective for this project was to outline and then implement a data science process—like CRISP-DM—resulting in a model that could reliably predict whether or not a customer would default on their loan(s) from their demographic information, as well as six months worth of data on their billing and payment history.
Obtain Data I obtained the raw data for this project from a MySQL database by establishing a connection to the server, executing a simple SELECT * query, and saving the result/output as a ."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  
  <header class="cover bg-top" style="background-image: url('https://katherinepiatti.com/images/credit_feature.webp');">
    <div class="pb3-m pb6-l bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://katherinepiatti.com/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        <img src="https://katherinepiatti.com/images/home.png" class="w100 mw5-ns" alt="Home" />
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://katherinepiatti.com/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://katherinepiatti.com/blog/" title="Blog page">
              Blog
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://katherinepiatti.com/post/" title="Projects page">
              Projects
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://katherinepiatti.com/resume_contact/" title="Resume | Contact page">
              Resume | Contact
            </a>
          </li>
          
        </ul>
      
      







<a href="https://linkedin.com/in/kpiatti" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>


<a href="https://github.com/kpiatti" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>








    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Credit Risk Assessment with Python</h1>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        PROJECTS
      </aside>
      




  <div id="sharing" class="mt3">

    
    <a href="https://www.facebook.com/sharer.php?u=https://katherinepiatti.com/post/creditone_project/" class="facebook no-underline" aria-label="share on Facebook">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

    </a>

    
    
    <a href="https://twitter.com/share?url=https://katherinepiatti.com/post/creditone_project/&amp;text=Credit%20Risk%20Assessment%20with%20Python" class="twitter no-underline" aria-label="share on Twitter">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

    </a>

    
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://katherinepiatti.com/post/creditone_project/&amp;title=Credit%20Risk%20Assessment%20with%20Python" class="linkedin no-underline" aria-label="share on LinkedIn">
      <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

    </a>
  </div>


      <h1 class="f1 athelas mt3 mb1">Credit Risk Assessment with Python</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="0001-01-01T00:00:00Z">January 1, 0001</time>

      
      
        <span class="f6 mv4 dib tracked"> - 12 minutes read</span>
        <span class="f6 mv4 dib tracked"> - 2474 words</span>
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>The prescribed objective for this project was to outline and then implement a data science process—like CRISP-DM—resulting in a model that could reliably predict whether or not a customer would default on their loan(s) from their demographic information, as well as six months worth of data on their billing and payment history.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h3 id="obtain-data"><em>Obtain Data</em></h3>
<p>I obtained the raw data for this project from a MySQL database by establishing a connection to the server, executing a simple SELECT * query, and saving the result/output as a .csv file. I use <a href="https://katherinepiatti.com/folder/creditone_data_info1.pdf">this</a> data supplement to understand what the column/variable names represent.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p> </p>
<h2 id="data-wrangling">Data Wrangling</h2>
<p>To get the data ready for analysis, I did the following:</p>
<ul>
<li>cleaned variable names to make them more meaningful and transparent</li>
<li>removed 72 rows of duplicate data (including 2 extra header rows)</li>
<li>dropped row containing the one and only missing value</li>
<li>changed variable data types from <em>object</em> to <em>int</em> (integer) where appropriate</li>
<li>reordered columns so all related variables are grouped together</li>
</ul>
<p>The cleaned data contains 30,000 observations &amp; 25 variables.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p> </p>
<h2 id="exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#import packages</span>
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns
plt<span style="color:#f92672">.</span>style<span style="color:#f92672">.</span>use(<span style="color:#e6db74">&#39;fivethirtyeight&#39;</span>)
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">from</span> pandas_profiling <span style="color:#f92672">import</span> ProfileReport

<span style="color:#75715e">#import cleaned data</span>
df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;cleaned_transformed_credit_one_data.csv&#39;</span>)
</code></pre></div><p><em>The observations that follow are primarily based on my analysis of the HTML pandas profile report I generated from the data.</em></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p> </p>
<h4 id="demographic-variables">Demographic Variables</h4>
<p><em>Age</em> &amp; <em>Sex</em>
<figure>
    <img src="https://katherinepiatti.com/images/creditone_age_sex_dist_plots.png"/> 
</figure>
</p>
<ul>
<li>Age range 21 - 79, Mean 35, Median 34</li>
<li>60.4% female, 39.6% male</li>
</ul>
<!-- raw HTML omitted -->
<p> 
<em>Education</em> &amp; <em>Marriage</em>
<figure>
    <img src="https://katherinepiatti.com/images/creditone_edu_mar_count_plots.png"/> 
</figure>
</p>
<ul>
<li>HS 16.4%, University 46.8%, Graduate School 35.3%, Other 1.6%</li>
<li>A disproportionate number of customers have university &amp; graduate degrees (compared to US population)</li>
<li>Married (1) 45.5%, Single (2) 53.6%, Divorced (3) 1.1%, Other 0.2%</li>
</ul>
<!-- raw HTML omitted -->
<p> </p>
<h4 id="account-variables">Account Variables</h4>
<p><em>Credit Limit</em>: the $ amount of credit each customer currently has</p>
<ul>
<li>Mean: 167,484; Mode: 50k (11.2%)</li>
<li>Distribution significantly skewed toward low limits</li>
<li>Wide range: 10k - 1M</li>
<li>Low variability: only 81 distinct values</li>
</ul>
<p><em>Default</em>: dummy variable, indicate whether the customer has or has not defaulted on their loans (we don&rsquo;t know the time frame determining this value, e.g. lifetime of account, at least once during last 7 yrs).</p>
<ul>
<li>Not default 77.9%, default 22.1%</li>
</ul>
<p><em>Repayment Variables</em></p>
<ul>
<li>-2 = no use, -1 = paid in full, 0 = use of revolving credit, 1= 1 month payment delay, 2= 2 month delay, &hellip;, 9= 9+ month delay (at what point are they coded as defaulted?)</li>
<li>All six variables have roughly the same, significantly skewed distributions (50%+ of values are 0, few values &gt;= 1)</li>
</ul>
<p> </p>
<h4 id="billing-variables">Billing Variables</h4>
<ul>
<li>The distributions for all six variables are roughly the same and just like the payment variables.</li>
<li>All variables have a non-trival number of negative values (this merits investigation for data integrity since negative values on bills presumably mean a customer was overcharged then issued a credit).</li>
</ul>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p> </p>
<h4 id="payment-variables">Payment Variables</h4>
<ul>
<li>There are 6 continuous payment variables - each represents the amount the customer paid towards their bill for the months of April to September 2005.</li>
<li>The distributions of the payment and billing variables have similar shapes.</li>
<li>Notable Differences:
<ul>
<li>The payment variables contain a higher percentage of zero values.</li>
<li>The payment variables don&rsquo;t contain any negative values.</li>
</ul>
</li>
</ul>
<p> </p>
<h3 id="correlation-analysis">Correlation Analysis</h3>
<p>If any of the features are highly correlated, that may be because they are actually tracking/representing the same information. Since high correlation between dependent variables can harm the performance of ML models, it needs to be handled.</p>
<p> </p>
<h3 id="are-the-6-billing-variables-correlated"><em>Are the 6 billing variables correlated?</em></h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#calculate kendall&#39;s tau correlation between billing vars</span>
df[ [<span style="color:#e6db74">&#39;bill_ap&#39;</span>, <span style="color:#e6db74">&#39;bill_m&#39;</span>, <span style="color:#e6db74">&#39;bill_ju&#39;</span>, <span style="color:#e6db74">&#39;bill_jy&#39;</span>, <span style="color:#e6db74">&#39;bill_ag&#39;</span>, <span style="color:#e6db74">&#39;bill_s&#39;</span>]]<span style="color:#f92672">.</span>corr(method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kendall&#39;</span>)<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">!</span>

<span style="color:#75715e"># name a sample of 1,000 data points selected from the df</span>
smpl<span style="color:#f92672">=</span>df<span style="color:#f92672">.</span>sample(n<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>)

<span style="color:#75715e">#create pairwise plots of bill features using smpl</span>
sns<span style="color:#f92672">.</span>pairplot(smpl, hue<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DEFAULT&#39;</span>, kind<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;scatter&#39;</span>, vars<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;bill_ap&#39;</span>,<span style="color:#e6db74">&#39;bill_m&#39;</span>, <span style="color:#e6db74">&#39;bill_ju&#39;</span>, <span style="color:#e6db74">&#39;bill_jy&#39;</span>, <span style="color:#e6db74">&#39;bill_ag&#39;</span>, <span style="color:#e6db74">&#39;bill_s&#39;</span>])

<span style="color:#75715e">#save plot as png</span>
plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">&#39;creditone_bill_pairplot.png&#39;</span>)
</code></pre></div><figure>
    <img src="https://katherinepiatti.com/images/creditone_bill_pairplot.png"/> 
</figure>

<ul>
<li>The billing variables are highly correlated with each other. Max: 0.8112, Min: 0.5853, which is not surprising since spending doesn&rsquo;t change from month to month.</li>
<li>In general, the correlation is highest between each monthly billing variable and the variable representing the month after. The correlation declines with each proceeding month (e.g. the correlation is highest between the April (bill_ap) and May (bill_m) billing variables, and declines for each subsequent month.)
<ul>
<li>May impact model performance. Consider only using one of the billing variables in model.</li>
</ul>
</li>
</ul>
<p> </p>
<h3 id="are-the-6-payment-variables-correlated"><em>Are the 6 payment variables correlated?</em></h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<figure>
    <img src="https://katherinepiatti.com/images/creditone_pmt_pairplot.png"/> 
</figure>

<ul>
<li>One reason to think the payment variables might be highly correlated is that presumably the amount customers pay each month is related to the amount they were billed during the previous month. If true, since the billing variables are highly correlated,  the payment variables would be too.</li>
<li>The kendall&rsquo;s correlation coefficients are between 0.348 and 0.4126. But the scatter plots don&rsquo;t show any relationship.</li>
<li>This suggests, somewhat surprising, that the amount customers pay each month is not really related to the amount they are billed.</li>
</ul>
<p> </p>
<h3 id="are-the-payment-variables-correlated-with-the-billing-variables"><em>Are the payment variables correlated with the billing variables?</em></h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#look at kendall&#39;s tau correlations b/t payment variables</span>
df[[<span style="color:#e6db74">&#39;bill_ap&#39;</span>, <span style="color:#e6db74">&#39;bill_m&#39;</span>, <span style="color:#e6db74">&#39;bill_ju&#39;</span>, <span style="color:#e6db74">&#39;bill_jy&#39;</span>, <span style="color:#e6db74">&#39;bill_ag&#39;</span>, <span style="color:#e6db74">&#39;bill_s&#39;</span>,<span style="color:#e6db74">&#39;pmt_ap&#39;</span>, <span style="color:#e6db74">&#39;pmt_m&#39;</span>, <span style="color:#e6db74">&#39;pmt_ju&#39;</span>, <span style="color:#e6db74">&#39;pmt_jy&#39;</span>, <span style="color:#e6db74">&#39;pmt_ag&#39;</span>, <span style="color:#e6db74">&#39;pmt_s&#39;</span>]]<span style="color:#f92672">.</span>corr(method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kendall&#39;</span>)
</code></pre></div><ul>
<li>I expected to find a moderate to high correlation between the billing and payment variables for reasons outlined abouve.</li>
<li>The strongest correlations are around 0.51.</li>
</ul>
<p> </p>
<h2 id="credit-limit-analysis">Credit Limit Analysis</h2>
<p>In this section I perform statistical tests to determine whether any of the dependent variables are related to the limit_bal target variable.</p>
<p> </p>
<h3 id="age-sex--credit-limit">Age, Sex, &amp; Credit Limit</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<figure>
    <img src="https://katherinepiatti.com/images/creditone_age_sex_plots.png"/> 
</figure>

<ul>
<li>There doesn&rsquo;t appear to be any sort of meaningful relationship between age and credit limit.</li>
<li>The similarity between the box plots for female and male indicates there is no difference in credit limits between men and women. That means SEX is unlikely to be a helpful variable to include in a model prediting LIMIT_BAL.</li>
</ul>
<p> </p>
<h3 id="education-marriage--credit-limit">Education, Marriage, &amp; Credit Limit</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<figure>
    <img src="https://katherinepiatti.com/images/creditone_edu_marriage_box.png"/> 
</figure>

<ul>
<li>The box plots for all education levels are very similar. Customers with a graduate education enjoy credit limits that are on average higher than the other groups. It also appears the credit limits for customers with a high school education are slightly skewed to the lower end. The differences aren&rsquo;t dramatic, but a customer&rsquo;s credit limit does appear to be somewhat related to their level of education</li>
<li>Although there are some small differences in the plots, it does not appear that a customer&rsquo;s credit limit is related to their marital status.</li>
</ul>
<p> </p>
<h2 id="credit-default-analysis">Credit Default analysis</h2>
<p>In this section I perform statistical tests to determine whether any of the dependent variables are related to whether or not customers in the sample default on their loans (DEFUALT).</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p> </p>
<h4 id="sex--default">Sex &amp; Default</h4>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<figure>
    <img src="https://katherinepiatti.com/images/creditone_sex_default_notdefault.png"/> 
</figure>

<p><em>Observations</em></p>
<ul>
<li>From the first plot, we can see that CreditOne&rsquo;s customers are slightly more likely to be female than male.</li>
<li>From the second set of plots, when we compare the data for customers who have defualted on their loans to the data for the customers who have not defaulted on their loans, it looks like customers who have defaulted on their loans are slightly more likely to be male than customers overall&ndash;however, it&rsquo;s unlikely this difference is statistically significant.</li>
<li>The fact that the relative probabilities of being female vs. male is almost the same among the customers who have defaulted and the customers who have not defualted suggests that sex will not be an important feature in a model predicting whether a customer will defualt on their loans.</li>
</ul>
<h4 id="education--default">Education &amp; Default</h4>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<figure>
    <img src="https://katherinepiatti.com/images/creditone_edu.png"/> 
</figure>

<p><em>Observations</em></p>
<ul>
<li>Since higher levels of education are highly correlated with higher levels of income, and higher levels of income are presumably correlated with lower rates of defaulting on loans. I was anticipating that customers with university and graduate school levels of education to be relatively less likely to default on their loans.</li>
<li>However, comparing the distributions of education levels for customers who have defaulted to the ebb</li>
</ul>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p> </p>
<h4 id="age--default">Age &amp; Default</h4>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<figure>
    <img src="https://katherinepiatti.com/images/creditone_age_default.png"/> 
</figure>

<p><em>Observations</em></p>
<ul>
<li>We can see in the above boxplot the the mean, IQR (middle 50% of data points), and range for the age variable are nearly identical for customers who defaulted on their loans (blue box) and for customers who did not defualt on their loans (orange box).</li>
<li>This suggests there is no significant relationship between a customer&rsquo;s age and whether or not she defaulted on her loans, which means AGE will not be an important feature in a model predicting whether a customer will default.</li>
</ul>
<p> </p>
<h4 id="marriage--default">Marriage &amp; Default</h4>
<p>Add description of method.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">5</span>), sharey<span style="color:#f92672">=</span>True)
axes[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;All Customers&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
axes[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Customers who defualted&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
axes[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Customers who did not default&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)

<span style="color:#75715e"># To iterate over all items in a multidimensional numpy array, use the `flat` attribute</span>
<span style="color:#66d9ef">for</span> ax <span style="color:#f92672">in</span> axes<span style="color:#f92672">.</span>flat:
    <span style="color:#75715e"># set xticks...</span>
    ax<span style="color:#f92672">.</span>set(xticks<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])

fig<span style="color:#f92672">.</span>suptitle(t<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Is there a relationship between customers marital status &amp; whether they defaulted?&#39;</span>, verticalalignment<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;baseline&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">18</span>)
labels<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Other&#39;</span>, <span style="color:#e6db74">&#39;Married&#39;</span>, <span style="color:#e6db74">&#39;Single&#39;</span>, <span style="color:#e6db74">&#39;Divorced&#39;</span>]


sns<span style="color:#f92672">.</span>histplot(ax<span style="color:#f92672">=</span>axes[<span style="color:#ae81ff">0</span>], data<span style="color:#f92672">=</span>df, x <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;MARRIAGE&#39;</span>, stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;probability&#39;</span>, discrete<span style="color:#f92672">=</span>True, shrink<span style="color:#f92672">=.</span><span style="color:#ae81ff">8</span>)
axes[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;&#39;</span>)
axes[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xticklabels(labels<span style="color:#f92672">=</span>labels, rotation<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>)

sns<span style="color:#f92672">.</span>histplot(ax<span style="color:#f92672">=</span>axes[<span style="color:#ae81ff">1</span>], data<span style="color:#f92672">=</span>dflt, x <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;MARRIAGE&#39;</span>, stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;probability&#39;</span>, discrete<span style="color:#f92672">=</span>True, shrink<span style="color:#f92672">=.</span><span style="color:#ae81ff">8</span>)
axes[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;&#39;</span>)
axes[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xticklabels(labels<span style="color:#f92672">=</span>labels, rotation<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>)

sns<span style="color:#f92672">.</span>histplot(ax<span style="color:#f92672">=</span>axes[<span style="color:#ae81ff">2</span>], data<span style="color:#f92672">=</span>nodflt, x <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;MARRIAGE&#39;</span>, stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;probability&#39;</span>, discrete<span style="color:#f92672">=</span>True, shrink<span style="color:#f92672">=.</span><span style="color:#ae81ff">8</span>)
axes[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>set_xticklabels(labels<span style="color:#f92672">=</span>labels, rotation<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>)
axes[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;&#39;</span>)
</code></pre></div><figure>
    <img src="https://katherinepiatti.com/images/creditone_marriage_default_notdefault.png"/> 
</figure>

<p><em>Observations</em></p>
<ul>
<li>From a comparison on the above plots, there appears that single customers are relatively less likely to default on their loans.</li>
</ul>
<p> </p>
<h3 id="billing--credit-default">Billing &amp; Credit Default</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<figure>
    <img src="https://katherinepiatti.com/images/creditone_billing_default.png"/> 
</figure>

<p><em>Observations</em></p>
<ul>
<li>I have more questions than observations.
<ul>
<li>It looks like there are some significant outliers. How can we find those data points in our df.</li>
<li>Other than some differences in outliers and a noticable difference in the length of the wiskers in bill_ag, all the box plots are basically the same. What, if anything, can we conclude from that?</li>
</ul>
</li>
</ul>
<p> </p>
<h3 id="payment--default">Payment &amp; Default</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">25</span>), sharey<span style="color:#f92672">=</span>True)

fig<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#39;Monthly Payment Variables Grouped by DEFAULT&#39;</span>)

sns<span style="color:#f92672">.</span>boxplot(ax<span style="color:#f92672">=</span>axes[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], data<span style="color:#f92672">=</span>df, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DEFAULT&#39;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pmt_ap&#39;</span>)
sns<span style="color:#f92672">.</span>boxplot(ax<span style="color:#f92672">=</span>axes[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], data<span style="color:#f92672">=</span>df, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DEFAULT&#39;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pmt_m&#39;</span>)
sns<span style="color:#f92672">.</span>boxplot(ax<span style="color:#f92672">=</span>axes[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>], data<span style="color:#f92672">=</span>df, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DEFAULT&#39;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pmt_ju&#39;</span>)
sns<span style="color:#f92672">.</span>boxplot(ax<span style="color:#f92672">=</span>axes[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>], data<span style="color:#f92672">=</span>df, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DEFAULT&#39;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pmt_jy&#39;</span>)
sns<span style="color:#f92672">.</span>boxplot(ax<span style="color:#f92672">=</span>axes[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>], data<span style="color:#f92672">=</span>df, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DEFAULT&#39;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pmt_ag&#39;</span>)
sns<span style="color:#f92672">.</span>boxplot(ax<span style="color:#f92672">=</span>axes[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], data<span style="color:#f92672">=</span>df, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DEFAULT&#39;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pmt_s&#39;</span>)

</code></pre></div><p><em>Observations</em></p>
<ul>
<li>I assume the boxplots for the payment variables look like this because there is a high % of zeros in these variables.</li>
<li>I also seem some signigicant outliers.</li>
</ul>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p> </p>
<h2 id="predicting-customer-credit-limits">Predicting Customer Credit Limits</h2>
<p>In this section my goal is to build and test models that attempt to predict customer credit limits. Which means the target variable in all models will be &lsquo;limit&rsquo; (i.e. limit_bal).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#75715e">#the inline magic line is needed to make some data visualizations come out right when you are using jupyter notebooks</span>
<span style="color:#f92672">%</span>matplotlib inline
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns
<span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> sqrt

<span style="color:#75715e">#ML algorithms (estimators)</span>
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestRegressor
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LinearRegression
<span style="color:#f92672">from</span> sklearn.svm <span style="color:#f92672">import</span> SVR
<span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> linear_model

<span style="color:#75715e">#model metrics</span>
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> mean_squared_error
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> r2_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score

<span style="color:#75715e">#cross validation</span>
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</code></pre></div><p> </p>
<h3 id="data-preparation">Data Preparation</h3>
<p>Add description and reasons for data transformations&ndash;one hot encoding</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h4 id="re-ordering-df-columns">Re-ordering df Columns</h4>
<p>To make things easier, before doing anything I&rsquo;m going to move LIMIT_BAL to the last column in my df and rename it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#step 1: create a variabled to hold the LIMIT_BAL var</span>
lim<span style="color:#f92672">=</span>df[<span style="color:#e6db74">&#39;LIMIT_BAL&#39;</span>]

<span style="color:#75715e">#step 2: drop the LIMIT_BAL column</span>
df<span style="color:#f92672">.</span>drop(labels<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;LIMIT_BAL&#39;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span>True)

<span style="color:#75715e">#step 3: insert &#39;lim&#39; as last column of df</span>
df<span style="color:#f92672">.</span>insert(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>, column<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;limit&#39;</span>, value<span style="color:#f92672">=</span>lim)

df<span style="color:#f92672">.</span>head()
</code></pre></div><h3 id="specify-the-target-variable">Specify the Target Variable</h3>
<p>Now I will specify the dependent or target variable for models attempting to predict customer credit limits.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#filter the data to return my dependent var (the limit column)</span>
y <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74">&#39;limit&#39;</span>]

<span style="color:#75715e">#verify that the first 5 values in y match the values in the limit column above</span>
y<span style="color:#f92672">.</span>head()
</code></pre></div><pre><code>0     20000
1    120000
2     90000
3     50000
4     50000
Name: limit, dtype: int64
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#verify that y has 30,000 rows</span>
y<span style="color:#f92672">.</span>shape
</code></pre></div><pre><code>(30000,)
</code></pre>
<p> </p>
<h2 id="model-1-using-all-dependent-variables">Model 1: Using All Dependent Variables</h2>
<p>None of the variables stood out as ones that should be included or excluded from the model, so in this first model I&rsquo;m going to include them all.</p>
<h3 id="specify-the-feature-variables">Specify the Feature Variables</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#filter the data to return only columns for my feature vars</span>
X <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">30</span>]

<span style="color:#75715e">#verify that all but the ID and limit columns were selected</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Summary of Feature Variables&#39;</span>)
X<span style="color:#f92672">.</span>head()
</code></pre></div><h2 id="train--test-model-1-using-3-different-regression-algorithms">Train &amp; Test Model 1 Using 3 Different Regression Algorithms</h2>
<p>Because credit limit is a continuous variable, I know I will have to use a regression model to predict it. But I don&rsquo;t have a principled reason to choose one regression algorithm over others, so I&rsquo;ll compare the predictions of models using Random Forest p9idifferent regression algorithms to find the one that works best on this task.</p>
<ul>
<li>I will run each model through a 3-fold cross validation test. Using R squared to score the models.</li>
<li>The model with the highest mean CV sore will be labeled best.</li>
</ul>
<h3 id="setup">Setup</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#create a dictionary to hold the algos</span>
algosClass <span style="color:#f92672">=</span> [ ]

<span style="color:#75715e">#add the randomn forest regressor to the dictionary</span>
algosClass<span style="color:#f92672">.</span>append((<span style="color:#e6db74">&#39;Random Forest Regressor&#39;</span>,RandomForestRegressor()))

<span style="color:#75715e">#add the liner regression algo to the dictionary</span>
algosClass<span style="color:#f92672">.</span>append((<span style="color:#e6db74">&#39;Linear Regression&#39;</span>,LinearRegression()))

<span style="color:#75715e">#add the SV regressor to the dictionary</span>
algosClass<span style="color:#f92672">.</span>append((<span style="color:#e6db74">&#39;Support Vector Regression&#39;</span>,SVR()))

<span style="color:#75715e">#verify every algo was added to the list</span>
<span style="color:#66d9ef">print</span>(algosClass)
</code></pre></div><pre><code>[('Random Forest Regressor', RandomForestRegressor()), ('Linear Regression', LinearRegression()), ('Support Vector Regression', SVR())]
</code></pre>
<h3 id="train--test-models">Train &amp; Test Models</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#create two empty lists to hold the names and cross validation results from each model</span>
results <span style="color:#f92672">=</span> []
names <span style="color:#f92672">=</span> []

<span style="color:#75715e">#create a for-loop that will</span>
<span style="color:#66d9ef">for</span> name, model <span style="color:#f92672">in</span> algosClass:
    result <span style="color:#f92672">=</span> cross_val_score(model, X,y, cv<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r2&#39;</span>)
    names<span style="color:#f92672">.</span>append(name)
    results<span style="color:#f92672">.</span>append(result)
</code></pre></div><h3 id="performance-results">Performance Results</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#run the for loop and print the mean cross validation score for each model</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(names)):
    <span style="color:#66d9ef">print</span>(names[i],results[i]<span style="color:#f92672">.</span>mean())
</code></pre></div><pre><code>Random Forest Regressor 0.46700202592747336
Linear Regression 0.35871695390197167
Support Vector Regression -0.05039128320492573
</code></pre>
<p>The model built using the random forest regressor performed slightly better than the other two models. However, did little better than chance at predicting customer&rsquo;s credit limits (i.e.limit_bal).</p>
<h2 id="model-2-excluding-demographic-variables">Model 2: Excluding Demographic Variables</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">## Select the Feature Variables</span>

<span style="color:#75715e">#filter the data to return only columns for bill amount, payment amount, payment history, and default var</span>
X2 <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">3</span>:<span style="color:#ae81ff">22</span>]

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Summary of Model 2 Features&#39;</span>)
X2<span style="color:#f92672">.</span>head()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#create two empty lists to hold the names and cross validation results from each model</span>
results2 <span style="color:#f92672">=</span> []
names2 <span style="color:#f92672">=</span> []

<span style="color:#75715e">#get cross validation scores for model 2</span>
<span style="color:#66d9ef">for</span> name, model <span style="color:#f92672">in</span> algosClass:
    result <span style="color:#f92672">=</span> cross_val_score(model, X2,y, cv<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r2&#39;</span>)
    names2<span style="color:#f92672">.</span>append(name)
    results2<span style="color:#f92672">.</span>append(result)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#run the for loop and print the mean cross validation score for each model</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Summary of Model2 Cross Validation Scores&#34;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(names2)):
    <span style="color:#66d9ef">print</span>(names[i],results[i]<span style="color:#f92672">.</span>mean())
</code></pre></div><pre><code>Summary of Model2 Cross Validation Scores
Random Forest Regressor 0.46700202592747336
Linear Regression 0.35871695390197167
Support Vector Regression -0.05039128320492573
</code></pre>
<h2 id="train--test-the-model">Train &amp; Test the Model</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#instantiate the random forest regression algo</span>
<span style="color:#75715e"># rfr = RandomForestRegressor()</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#train the rfr model on X_train and y_train</span>
<span style="color:#75715e"># model = rfr.fit(X_train, y_train)</span>

<span style="color:#75715e">#use trained model to predict credit limit amounts for the X_test data</span>
<span style="color:#75715e"># y_predict = model_1.predict(X_test)</span>
</code></pre></div><h2 id="split-data-into-training-and-testing-sets">Split Data into Training and Testing Sets</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.2</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">123</span>)
</code></pre></div><blockquote>
<p><em>Coding Notes</em></p>
<ul>
<li>The <code>test_size =</code> parameter specifies what percent of you dataset will be used for training and training. If you don&rsquo;t specify an amount, the default is 0.25.</li>
<li>The <code>random_state =</code> parameter can be set to any number. The purpose of it is to make sure that every time the model is run,  the same observations are used in the training and testing sets. If this parameter is not included, every time you run the model it may select a slightly different set of observations.</li>
</ul>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cross_val_score(rfr, X, y, cv<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">r2_score(y_test, y_predict)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">mean_squared_error(y_test, y_predict)
</code></pre></div><p><a href="https://github.com/kpiatti/creditone-project">Link to GitHub Repository</a></p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://katherinepiatti.com" >
    &copy;  Home 2021 
  </a>
    <div>







<a href="https://linkedin.com/in/kpiatti" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>


<a href="https://github.com/kpiatti" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







</div>
  </div>
</footer>

  </body>
</html>
